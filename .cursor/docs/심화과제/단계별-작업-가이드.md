# ì‹¬í™”ê³¼ì œ ë‹¨ê³„ë³„ ì‘ì—… ê°€ì´ë“œ

## ğŸ“Œ í˜„ì¬ ìƒí™©

### Basic í´ë”ì˜ Props Drilling ë¬¸ì œ

- `PagesLayout`ì—ì„œ **20ê°œ ì´ìƒì˜ props**ë¥¼ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì— ì „ë‹¬
- ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ë“¤ì´ propsë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì „ë‹¬ë§Œ í•¨
- ì½”ë“œ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„± ì €í•˜

### ëª©í‘œ

- ì „ì—­ ìƒíƒœ ê´€ë¦¬ ë„êµ¬ë¡œ Props Drilling ì œê±°
- í•„ìš”í•œ propsë§Œ ì „ë‹¬í•˜ë„ë¡ ê°œì„ 
- í…ŒìŠ¤íŠ¸ ì½”ë“œ í†µê³¼

---

## ğŸš€ ë‹¨ê³„ë³„ ì‘ì—… ìˆœì„œ

### Step 1: Jotai ì„¤ì¹˜

#### 1.1 Jotai ì„¤ì¹˜

```bash
pnpm add jotai
```

Jotaië¥¼ ì„ íƒí•œ ì´ìœ :

- âœ… ê°„ë‹¨í•˜ê³  ì§ê´€ì ì¸ API
- âœ… ìë™ ìµœì í™” (ìˆ˜ë™ ìµœì í™” ë¶ˆí•„ìš”)
- âœ… ì ì€ ì½”ë“œëŸ‰ (Context API ëŒ€ë¹„ 1/4)
- âœ… ë‚®ì€ í•™ìŠµ ê³¡ì„ 

---

### Step 2: ìƒíƒœ ë¶„ì„ ë° ê·¸ë£¹í™”

#### 2.1 í˜„ì¬ ì „ë‹¬ë˜ëŠ” Props ë¶„ì„

`PagesLayout.tsx`ì—ì„œ ì „ë‹¬í•˜ëŠ” propsë¥¼ ë¶„ì„:

**Cart ê´€ë ¨ ìƒíƒœ:**

- `cart`, `selectedCoupon`, `total`, `totalItemCount`
- `addToCart`, `removeFromCart`, `updateQuantity`
- `applyCoupon`, `setSelectedCoupon`, `completeOrder`

**Product ê´€ë ¨ ìƒíƒœ:**

- `products`, `searchTerm`
- `getRemainingStockForProduct`

**Admin ê´€ë ¨ ìƒíƒœ:**

- `isAdmin`, `activeTab`
- `showProductForm`, `showCouponForm`
- `editingProduct`, `productForm`, `couponForm`
- `handleAddProduct`, `handleUpdateProduct`, `handleDeleteProduct`
- `handleAddCoupon`, `handleDeleteCoupon`
- `handleProductSubmit`, `handleCouponSubmit`
- `startEditProduct`

**Notification ê´€ë ¨ ìƒíƒœ:**

- `notifications`, `removeNotification`, `addNotification`

**UI ê´€ë ¨:**

- `formatPrice` (ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜)

#### 2.2 ìƒíƒœ ê·¸ë£¹í™” ê³„íš (Jotai Atoms)

```
â–¡ cartAtoms.ts
  - cartAtom: CartItem[]
  - selectedCouponAtom: Coupon | null
  - totalAtom (derived): number
  - totalItemCountAtom (derived): number
  - addToCartAtom (write-only)
  - removeFromCartAtom (write-only)
  - updateQuantityAtom (write-only)
  - applyCouponAtom (write-only)
  - completeOrderAtom (write-only)

â–¡ productAtoms.ts
  - productsAtom: ProductWithUI[]
  - searchTermAtom: string
  - filteredProductsAtom (derived): ProductWithUI[]

â–¡ adminAtoms.ts
  - isAdminAtom: boolean
  - activeTabAtom: 'products' | 'coupons'
  - showProductFormAtom: boolean
  - showCouponFormAtom: boolean
  - editingProductAtom: string | 'new' | null
  - productFormAtom: ProductFormData
  - couponFormAtom: CouponFormData
  - couponsAtom: Coupon[]
  - handleAddProductAtom (write-only)
  - handleUpdateProductAtom (write-only)
  - handleDeleteProductAtom (write-only)
  - handleAddCouponAtom (write-only)
  - handleDeleteCouponAtom (write-only)

â–¡ notificationAtoms.ts
  - notificationsAtom: Notification[]
  - addNotificationAtom (write-only)
  - removeNotificationAtom (write-only)
```

---

### Step 3: Jotai Atom êµ¬ì¶•

#### 3.1 Atom íŒŒì¼ ìƒì„±

```
src/advanced/atoms/
â”œâ”€â”€ cartAtoms.ts
â”œâ”€â”€ productAtoms.ts
â”œâ”€â”€ adminAtoms.ts
â””â”€â”€ notificationAtoms.ts
```

#### 3.2 cartAtoms.ts êµ¬í˜„

**ê¸°ë³¸ Atoms:**

- [ ] `cartAtom` - ì¥ë°”êµ¬ë‹ˆ ì•„ì´í…œ ë°°ì—´
- [ ] `selectedCouponAtom` - ì„ íƒëœ ì¿ í°

**Derived Atoms:**

- [ ] `totalAtom` - ì¥ë°”êµ¬ë‹ˆ ì´ì•¡ ê³„ì‚°
- [ ] `totalItemCountAtom` - ì¥ë°”êµ¬ë‹ˆ ì•„ì´í…œ ì´ ê°œìˆ˜

**Write-only Atoms (ì•¡ì…˜):**

- [ ] `addToCartAtom` - ìƒí’ˆ ì¶”ê°€
- [ ] `removeFromCartAtom` - ìƒí’ˆ ì œê±°
- [ ] `updateQuantityAtom` - ìˆ˜ëŸ‰ ì—…ë°ì´íŠ¸
- [ ] `applyCouponAtom` - ì¿ í° ì ìš©
- [ ] `setSelectedCouponAtom` - ì¿ í° ì„ íƒ
- [ ] `completeOrderAtom` - ì£¼ë¬¸ ì™„ë£Œ

**ì˜ˆì‹œ ì½”ë“œ:**

```typescript
import { atom } from "jotai";
import { CartItem, Coupon } from "../../../types";
import { calculateCartTotal } from "../../models/cart";

export const cartAtom = atom<CartItem[]>([]);
export const selectedCouponAtom = atom<Coupon | null>(null);

export const totalAtom = atom((get) => {
  const cart = get(cartAtom);
  const coupon = get(selectedCouponAtom);
  return calculateCartTotal(cart, coupon);
});

export const addToCartAtom = atom(null, (get, set, product: Product) => {
  // addToCart ë¡œì§
});
```

#### 3.3 productAtoms.ts êµ¬í˜„

**ê¸°ë³¸ Atoms:**

- [ ] `productsAtom` - ìƒí’ˆ ëª©ë¡
- [ ] `searchTermAtom` - ê²€ìƒ‰ì–´

**Derived Atoms:**

- [ ] `filteredProductsAtom` - í•„í„°ë§ëœ ìƒí’ˆ ëª©ë¡

**Write-only Atoms:**

- [ ] `addProductAtom` - ìƒí’ˆ ì¶”ê°€
- [ ] `updateProductAtom` - ìƒí’ˆ ìˆ˜ì •
- [ ] `deleteProductAtom` - ìƒí’ˆ ì‚­ì œ

#### 3.4 adminAtoms.ts êµ¬í˜„

**ê¸°ë³¸ Atoms:**

- [ ] `isAdminAtom` - ê´€ë¦¬ì ëª¨ë“œ ì—¬ë¶€
- [ ] `activeTabAtom` - ê´€ë¦¬ì í˜ì´ì§€ íƒ­
- [ ] `showProductFormAtom` - ìƒí’ˆ í¼ í‘œì‹œ ì—¬ë¶€
- [ ] `showCouponFormAtom` - ì¿ í° í¼ í‘œì‹œ ì—¬ë¶€
- [ ] `editingProductAtom` - ìˆ˜ì • ì¤‘ì¸ ìƒí’ˆ ID
- [ ] `productFormAtom` - ìƒí’ˆ í¼ ë°ì´í„°
- [ ] `couponFormAtom` - ì¿ í° í¼ ë°ì´í„°
- [ ] `couponsAtom` - ì¿ í° ëª©ë¡

**Write-only Atoms:**

- [ ] `toggleAdminAtom` - ê´€ë¦¬ì ëª¨ë“œ í† ê¸€
- [ ] `setActiveTabAtom` - íƒ­ ë³€ê²½
- [ ] `handleAddProductAtom` - ìƒí’ˆ ì¶”ê°€ ì²˜ë¦¬
- [ ] `handleUpdateProductAtom` - ìƒí’ˆ ìˆ˜ì • ì²˜ë¦¬
- [ ] `handleDeleteProductAtom` - ìƒí’ˆ ì‚­ì œ ì²˜ë¦¬
- [ ] `handleAddCouponAtom` - ì¿ í° ì¶”ê°€ ì²˜ë¦¬
- [ ] `handleDeleteCouponAtom` - ì¿ í° ì‚­ì œ ì²˜ë¦¬

#### 3.5 notificationAtoms.ts êµ¬í˜„

**ê¸°ë³¸ Atoms:**

- [ ] `notificationsAtom` - ì•Œë¦¼ ëª©ë¡

**Write-only Atoms:**

- [ ] `addNotificationAtom` - ì•Œë¦¼ ì¶”ê°€
- [ ] `removeNotificationAtom` - ì•Œë¦¼ ì œê±°

#### 3.6 Provider ì„¤ì •

- [ ] `App.tsx`ì— `<Provider>` ì¶”ê°€

```typescript
import { Provider } from "jotai";

const App = () => {
  return (
    <Provider>
      <PagesLayout />
    </Provider>
  );
};
```

---

### Step 4: PagesLayout ë¦¬íŒ©í† ë§

#### 4.1 useApp() hook ìˆ˜ì •

- [ ] ì „ì—­ ìƒíƒœë¡œ ì´ë™í•œ ê²ƒë“¤ì„ `useApp()`ì—ì„œ ì œê±°
- [ ] ë‚¨ì€ ê²ƒë“¤ë§Œ `useApp()`ì—ì„œ ê´€ë¦¬ (ì˜ˆ: formatPrice ê°™ì€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜)

#### 4.2 PagesLayout ì»´í¬ë„ŒíŠ¸ ìˆ˜ì •

- [ ] Jotai atomsì—ì„œ í•„ìš”í•œ ê²ƒë§Œ ê°€ì ¸ì˜¤ê¸°
- [ ] props ì „ë‹¬ ìˆ˜ ìµœì†Œí™” (20ê°œ ì´ìƒ â†’ 5ê°œ ì´í•˜)

**Before:**

```typescript
const {
  cart,
  products,
  coupons,
  isAdmin,
  activeTab,
  // ... 20ê°œ ì´ìƒì˜ props
} = useApp();

<AdminPage
  activeTab={activeTab}
  setActiveTab={setActiveTab}
  products={products}
  // ... 20ê°œ ì´ìƒì˜ props
/>;
```

**After:**

```typescript
// useApp()ì—ì„œ ì „ì—­ ìƒíƒœ ì œê±°
// ê° ì»´í¬ë„ŒíŠ¸ì—ì„œ ì§ì ‘ atoms ì‚¬ìš©

<AdminPage />
// ë˜ëŠ” ìµœì†Œí•œì˜ propsë§Œ
```

---

### Step 5: ê° ì»´í¬ë„ŒíŠ¸ ë¦¬íŒ©í† ë§

#### 5.1 AdminPage ë¦¬íŒ©í† ë§

- [ ] ì „ì—­ ìƒíƒœì—ì„œ í•„ìš”í•œ ê²ƒë§Œ ê°€ì ¸ì˜¤ê¸°
- [ ] Drilling props ì œê±°
- [ ] Domain propsëŠ” ìœ ì§€

#### 5.2 CartPage ë¦¬íŒ©í† ë§

- [ ] ì „ì—­ ìƒíƒœì—ì„œ cart, products ë“± ê°€ì ¸ì˜¤ê¸°
- [ ] ë¶ˆí•„ìš”í•œ props ì „ë‹¬ ì œê±°

#### 5.3 Header ë¦¬íŒ©í† ë§

- [ ] Jotai atomsì—ì„œ `isAdmin`, `searchTerm` ê°€ì ¸ì˜¤ê¸°
  ```typescript
  const [isAdmin, toggleAdmin] = useAtom(isAdminAtom);
  const [searchTerm, setSearchTerm] = useAtom(searchTermAtom);
  ```
- [ ] props ì „ë‹¬ ì œê±°

#### 5.4 Feature ì»´í¬ë„ŒíŠ¸ë“¤ ë¦¬íŒ©í† ë§

- [ ] `ProductCard`: Jotai atomsì—ì„œ í•„ìš”í•œ ê²ƒë§Œ ê°€ì ¸ì˜¤ê¸°
  ```typescript
  const [, addToCart] = useAtom(addToCartAtom);
  ```
- [ ] `Cart`: Jotai atomsì—ì„œ cart ì •ë³´ ê°€ì ¸ì˜¤ê¸°
  ```typescript
  const [cart] = useAtom(cartAtom);
  const [total] = useAtom(totalAtom);
  ```
- [ ] `ProductManagement`: Jotai atomsì—ì„œ products ê°€ì ¸ì˜¤ê¸°
  ```typescript
  const [products] = useAtom(productsAtom);
  ```
- [ ] `CouponManagement`: Jotai atomsì—ì„œ coupons ê°€ì ¸ì˜¤ê¸°
  ```typescript
  const [coupons] = useAtom(couponsAtom);
  ```

---

### Step 6: Props ì •ë¦¬

#### 6.1 Domain Props ìœ ì§€

ë‹¤ìŒê³¼ ê°™ì€ propsëŠ” **ë°˜ë“œì‹œ ìœ ì§€**í•´ì•¼ í•©ë‹ˆë‹¤:

- âœ… `ProductCard`ì˜ `product` prop
- âœ… `CartItem`ì˜ `item` prop
- âœ… ì½œë°± props (`onAddToCart`, `onEditProduct` ë“±) - ë‹¨, ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬ ê°€ëŠ¥í•˜ë©´ ì œê±°

#### 6.2 Drilling Props ì œê±°

ë‹¤ìŒê³¼ ê°™ì€ propsëŠ” **ì œê±°**í•´ì•¼ í•©ë‹ˆë‹¤:

- âŒ ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” props
- âŒ ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬ë˜ëŠ” props
- âŒ ë‹¨ìˆœíˆ ì „ë‹¬ë§Œ í•˜ëŠ” props

---

### Step 7: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦

#### 7.1 ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

- [ ] ì¥ë°”êµ¬ë‹ˆ ì¶”ê°€/ì œê±° ê¸°ëŠ¥
- [ ] ìƒí’ˆ ê²€ìƒ‰ ê¸°ëŠ¥
- [ ] ê´€ë¦¬ì í˜ì´ì§€ ê¸°ëŠ¥
- [ ] ì¿ í° ì ìš© ê¸°ëŠ¥
- [ ] ì•Œë¦¼ ê¸°ëŠ¥

#### 7.2 í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‹¤í–‰

```bash
pnpm test src/advanced/__tests__/origin.test.tsx
```

- [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ í†µê³¼ í™•ì¸

#### 7.3 Props Drilling ì œê±° í™•ì¸

- [ ] `PagesLayout`ì—ì„œ ì „ë‹¬í•˜ëŠ” props ìˆ˜ í™•ì¸
  - Before: 20ê°œ ì´ìƒ
  - After: 5ê°œ ì´í•˜ (ë˜ëŠ” 0ê°œ)
- [ ] ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” props ì œê±° í™•ì¸

---

## ğŸ“‹ ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ ì‘ì—…

- [ ] ì „ì—­ ìƒíƒœ ê´€ë¦¬ ë„êµ¬ ì„ íƒ ë° ì„¤ì¹˜
- [ ] ì „ì—­ ìƒíƒœ ê´€ë¦¬ êµ¬ì¶• ì™„ë£Œ
- [ ] PagesLayoutì—ì„œ props ìˆ˜ê°€ í¬ê²Œ ê°ì†Œ (20ê°œ ì´ìƒ â†’ 5ê°œ ì´í•˜)
- [ ] Domain propsëŠ” ìœ ì§€í•˜ê³  Drilling props ì œê±°
- [ ] ëª¨ë“  ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™
- [ ] í…ŒìŠ¤íŠ¸ ì½”ë“œ í†µê³¼

### ê¶Œì¥ ì‘ì—…

- [ ] ì„±ëŠ¥ ìµœì í™” (ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€)
- [ ] ì½”ë“œ ì£¼ì„ ë° ë¬¸ì„œí™”
- [ ] íƒ€ì… ì•ˆì •ì„± í™•ì¸

---

## ğŸ¯ ì„±ê³µ ê¸°ì¤€

### Props Drilling ì œê±° ì„±ê³µ

- âœ… `PagesLayout`ì—ì„œ ì „ë‹¬í•˜ëŠ” propsê°€ **5ê°œ ì´í•˜**ë¡œ ê°ì†Œ
- âœ… ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” props ì œê±°
- âœ… ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬ë˜ëŠ” propsëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ ì§ì ‘ ê°€ì ¸ì˜¤ê¸°

### ê¸°ëŠ¥ ìœ ì§€

- âœ… ëª¨ë“  ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™
- âœ… í…ŒìŠ¤íŠ¸ ì½”ë“œ í†µê³¼
- âœ… originê³¼ ë™ì¼í•œ ë™ì‘

### ì½”ë“œ í’ˆì§ˆ

- âœ… ì½”ë“œ ê°€ë…ì„± í–¥ìƒ
- âœ… ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
- âœ… ì»´í¬ë„ŒíŠ¸ ê°„ ê²°í•©ë„ ê°ì†Œ

---

## ğŸ’¡ íŒ

1. **ì ì§„ì  ë¦¬íŒ©í† ë§**

   - í•œ ë²ˆì— ëª¨ë“  ê²ƒì„ ë°”ê¾¸ì§€ ë§ê³ , í•˜ë‚˜ì”© ë‹¨ê³„ì ìœ¼ë¡œ ì§„í–‰
   - ì˜ˆ: ë¨¼ì € Cart ê´€ë ¨ ìƒíƒœë§Œ ì „ì—­í™” â†’ í…ŒìŠ¤íŠ¸ â†’ ë‹¤ìŒ ë‹¨ê³„

2. **Domain Props íŒë‹¨**

   - ì»´í¬ë„ŒíŠ¸ë¥¼ ì¬ì‚¬ìš©í•  ë•Œ ë‹¤ë¥¸ ê°’ì„ ì „ë‹¬í•´ì•¼ í•˜ëŠ”ê°€?
   - Yes â†’ Domain Props (ìœ ì§€)
   - No â†’ ì „ì—­ ìƒíƒœë¡œ ì´ë™ ê³ ë ¤

3. **ì„±ëŠ¥ ê³ ë ¤**

   - JotaiëŠ” ìë™ìœ¼ë¡œ ìµœì í™”ë˜ì§€ë§Œ, `useAtomValue`, `useSetAtom` ì‚¬ìš© ê¶Œì¥
   - ì½ê¸°ë§Œ í•  ë•Œ: `useAtomValue(atom)`
   - ì“°ê¸°ë§Œ í•  ë•Œ: `useSetAtom(atom)`
   - ì½ê¸°/ì“°ê¸° ëª¨ë‘: `useAtom(atom)`

4. **í…ŒìŠ¤íŠ¸ ì£¼ê¸°ì  ì‹¤í–‰**
   - ê° ë‹¨ê³„ë§ˆë‹¤ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ê¸°ëŠ¥ì´ ê¹¨ì§€ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
